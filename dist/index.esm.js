import h,{useEffect as Ue,useState as qe}from"react";import x from"react";import{Vault as ve}from"@iiif/vault";var L={isLoaded:!1,itemHeight:void 0,vault:new ve},K=x.createContext(L),Q=x.createContext(L);function $e(e,t){switch(t.type){case"updateIsLoaded":return{...e,isLoaded:t.isLoaded};case"updateItemHeight":return{...e,itemHeight:t.itemHeight};default:throw new Error(`Unhandled action type: ${t.type}`)}}var X=({initialState:e=L,children:t})=>{let[r,o]=x.useReducer($e,e);return x.createElement(K.Provider,{value:r},x.createElement(Q.Provider,{value:o},t))};function v(){let e=x.useContext(K);if(e===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return e}function Y(){let e=x.useContext(Q);if(e===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return e}import $,{useEffect as Ee,useState as j,useRef as Te}from"react";import H,{useEffect as T,useState as S}from"react";import u,{useEffect as ze,useRef as ke,useState as Ae}from"react";import{Label as Pe,Summary as Fe}from"@samvera/nectar-iiif";import{createStitches as Se}from"@stitches/react";var d=e=>1.618**e;var Z={1:"0.382rem",2:"0.618rem",3:"1rem",4:"1.618rem",5:`calc(1rem * ${d(2)})`,6:`calc(1rem * ${d(3)})`,7:`calc(1rem * ${d(4)})`,8:`calc(1rem * ${d(5)})`,9:`calc(1rem * ${d(6)})`,10:`calc(1rem * ${d(7)})`,11:`calc(1rem * ${d(8)})`,12:`calc(1rem * ${d(9)})`},we={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"#006adc",accentMuted:"#5eb0ef",accentAlt:"#00254d",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fonts:{sans:"'Inter', Arial, sans-serif",display:"'Calistoga', 'Inter', Arial, sans-serif"},fontSizes:{1:"0.611rem",2:"0.722rem",3:"0.833rem",4:"1rem",5:"1.177rem",6:"1.318rem",7:`calc(1rem * ${d(1)})`,8:`calc(1rem * ${d(2)})`,9:`calc(1rem * ${d(3)})`},sizes:{...Z},space:{...Z},transitions:{all:"all 250ms cubic-bezier(0.16, 1, 0.3, 1)",load:"all 1.25s cubic-bezier(0.16, 1, 0.3, 1)"}},Ie={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",xl:"(max-width: 1199px)",lg:"(min-width: 1200px)"},{styled:n,css:et,keyframes:tt,createTheme:ot}=Se({theme:we,media:Ie});var D=n("div",{position:"absolute",width:"100%",backgroundColor:"green"}),P=n("figure",{display:"flex",flexDirection:"column",margin:"0 0 $2",flexGrow:"0",flexShrink:"0",borderRadius:"3px",transition:"$all",img:{position:"absolute",display:"flex",flexDirection:"column",objectFit:"cover",zIndex:"0",width:"100%",height:"100%",color:"transparent"},video:{position:"absolute",display:"flex",flexDirection:"column",objectFit:"cover",zIndex:"1",width:"100%",height:"100%",color:"transparent",opacity:"0",transition:"$load",borderRadius:"3px"},figcaption:{display:"flex",flexDirection:"column",padding:"$2 0",color:"$primary",transition:"$all"},variants:{isFocused:{true:{margin:"-$2 -$2 0",video:{opacity:"1"},figcaption:{padding:"$2",color:"$accent"},[`& ${D}`]:{width:"calc(100% - ($2 * 2))"}}}}}),F=n("span",{display:"flex",position:"relative",backgroundColor:"$secondaryAlt",width:"100%",height:"100%",overflow:"hidden",borderRadius:"3px",boxShadow:"none",transition:"$all"}),_=n(Pe,{fontSize:"$3",fontWeight:"700"}),ee=n(Fe,{fontSize:"$2",marginTop:"$1",color:"$primary"});import*as te from"@radix-ui/react-aspect-ratio";import{Thumbnail as He}from"@samvera/nectar-iiif";var Me=({index:e,isFocused:t,label:r,summary:o,thumbnail:i})=>{let s=Y(),[g,p]=Ae(!1),c=ke(null);return ze(()=>{let m=new ResizeObserver(a=>{for(let l of a)if(l.contentBoxSize){let M=Array.isArray(l.contentBoxSize)?l.contentBoxSize[0]:l.contentBoxSize;s({type:"updateItemHeight",itemHeight:M.inlineSize})}});e===0&&c.current&&m.observe(c.current)},[e,g]),i[0].type==="ContentResource"?u.createElement(u.Fragment,null):u.createElement(P,{isFocused:t},u.createElement(te.Root,{ratio:1/1},u.createElement(D,{ref:c}),u.createElement(F,null,u.createElement(He,{altAsLabel:r,css:{objectFit:"cover",width:"100%",height:"100%"},onLoad:()=>p(!0),thumbnail:i}))),u.createElement("figcaption",null,u.createElement(_,{label:r}),o&&u.createElement(ee,{summary:o})))},oe=Me;var N=n("a",{color:"black",textDecoration:"none"}),z=n("div",{position:"relative",width:"calc(100% / 4)",zIndex:"0",borderRadius:"3px",[`> ${N}:hover`]:{[`${P}`]:{boxShadow:"3px 3px 11px #0003"},[`${F}`]:{borderBottomLeftRadius:"0",borderBottomRightRadius:"0"}}});import f,{useEffect as Le,useState as se}from"react";var re=n("div",{position:"absolute",zIndex:"2",left:"-$2",top:"-$2",width:"calc(100% + (0.618rem * 2))",opacity:"0",variants:{isFocused:{true:{opacity:"1"}}}}),ne=n("div",{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end",zIndex:"1"}),ie=n("div",{display:"flex",justifyContent:"center",padding:"$2 $2 0",background:"linear-gradient(0deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 100%)",cursor:"default",button:{width:"$4",height:"$4",display:"flex",flexDirection:"column",textAlign:"center",justifyContent:"center",alignItems:"center",borderRadious:"100%",backgroundColor:"transparent",border:"none",cursor:"pointer","&:disabled":{opacity:"0.2"},svg:{width:"100%",fill:"$secondary",stroke:"$secondary",color:"$secondary"}}}),ae=n("div",{display:"flex",justifyContent:"center",backgroundColor:"rgba(0,0,0,0.7)",color:"$secondaryAlt",fontSize:"$1",padding:"$1",cursor:"default"});import*as le from"@radix-ui/react-aspect-ratio";import B from"react";var k=()=>B.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},B.createElement("title",null,"Next"),B.createElement("path",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",strokeWidth:"70",d:"M268 112l144 144-144 144M392 256H100"}));import E from"react";var A=()=>E.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},E.createElement("title",null,"Previous"),E.createElement("path",{fill:"none",stroke:"currentColor",strokeMiterlimit:"10",strokeWidth:"70",d:"M244 400L100 256l144-144M120 256h292"}));var De=({activeCanvas:e,handleActiveCanvas:t,isFocused:r,manifest:o})=>{let[i,s]=se(!1),[g,p]=se(!1),c=e+1,m=0;return o&&(m=o.items.length),Le(()=>{c<=1?s(!1):s(!0),c>=m?p(!1):p(!0)},[e,o]),f.createElement(re,{isFocused:r},f.createElement(le.Root,{ratio:1/1},o&&f.createElement(ne,null,f.createElement(ie,{onClick:a=>a.preventDefault()},f.createElement("button",{onClick:()=>t(-1),disabled:!i},f.createElement(A,null)),f.createElement("button",{onClick:()=>t(1),disabled:!g},f.createElement(k,null))),f.createElement(ae,{onClick:a=>a.preventDefault()},c," of ",m))))},ce=De;var me=(e,t)=>{if(e.thumbnail.length!==0)return e.thumbnail;let r=t.get(e.items[0]);return t.get(r.items[0]).body};var Ne=({index:e,item:t})=>{var U;let r=v(),{vault:o}=r,[i,s]=S(!1),[g,p]=S(0),[c,m]=S(t.thumbnail),[a,l]=S(),[M,xe]=S(t.id);T(()=>{i&&setTimeout(()=>{a||o.loadManifest(t.id).then(b=>l(b)).catch(b=>{console.error(`Manifest failed to load: ${b}`)})},1e3)},[i]),T(()=>{let b=o.get(t.thumbnail);m(b)},[]);let O=()=>s(!0),V=()=>s(!1),W=b=>{if(!a)return;let q=g+b,J=o.get(a.items[q]),Ce=me(J,o),ye=o.get(Ce);xe(J.id),m(ye),p(q)};T(()=>{a&&W(0)},[a]);let G;return((U=t.homepage)==null?void 0:U.length)>0&&(G=t.homepage[0].id),H.createElement(z,null,H.createElement(N,{href:G,tabIndex:0,onFocus:O,onBlur:V,onMouseEnter:O,onMouseLeave:V},H.createElement(oe,{index:e,isFocused:i,key:M,label:t.label,summary:t.summary,thumbnail:c}),H.createElement(ce,{manifest:a,activeCanvas:g,handleActiveCanvas:W,isFocused:i})))},de=Ne;var ue=n("div",{position:"relative",display:"flex",flexDirection:"row",[`> ${z}`]:{marginRight:"$4","&:last-child":{marginRight:"0"}}});import y from"react";var w=n("div",{position:"absolute",background:"black",borderRadius:"3px",opacity:"0",transition:"$all"}),C=n("div",{position:"absolute",display:"flex",flexDirection:"column",width:"$4",height:"$4",borderRadius:"100%",backgroundColor:"white",justifyContent:"center",textAlign:"center",alignItems:"center",boxShadow:"none",transform:"none",transition:"$all",svg:{display:"flex",width:"$3",height:"$3",fill:"$primary",stroke:"$primary",color:"$primary",transition:"$all"}}),pe=n("button",{position:"absolute",height:"100%",zIndex:"1",border:"none",cursor:"pointer",background:"transparent",["&:disabled"]:{opacity:"0",transform:"scale(0)"},["&:hover"]:{[`> ${w}`]:{opacity:1},[`> ${C}`]:{boxShadow:"3px 3px 11px #0003",svg:{fill:"$accent",stroke:"$accent",color:"$accent"}}},variants:{value:{next:{left:"unset",right:"0",[`> ${w}`]:{left:"unset",right:"0",top:"0",background:"linear-gradient(270deg, rgba(0,0,0,0.7) 38.2%, rgba(0,0,0,0) 98%)"},[`> ${C}`]:{right:"calc(-$4 / 2)",marginTop:"calc(-$4 / 2)"},[`&:hover > ${C}`]:{marginRight:"$1"}},previous:{left:"0",right:"unset",[`> ${w}`]:{left:"0",right:"unset",top:"0",background:"linear-gradient(90deg, rgba(0,0,0,0.7) 38.2%, rgba(0,0,0,0) 98%)"},[`> ${C}`]:{left:"calc(-$4 / 2)",marginTop:"calc(-$4 / 2)"},[`&:hover > ${C}`]:{marginLeft:"$1"}}}}});var Be=({disabled:e,handleControl:t,height:r,increment:o,label:i})=>{let s=r*.382;return y.createElement(y.Fragment,null,y.createElement(pe,{"aria-label":i,direction:i,onClick:()=>t(o),style:{height:`${r}px`,width:`${s}px`},disabled:e,value:i},y.createElement(w,{style:{height:`${r}px`,width:`${s}px`}}),y.createElement(C,null,i==="next"&&y.createElement(k,null),i==="previous"&&y.createElement(A,null))))},R=Be;var Re=({items:e})=>{let{itemHeight:t}=v(),[r,o]=j([0,1,2,3,4]),[i,s]=j(!1),[g,p]=j(!1),c=Te(null);Ee(()=>{!e||(r.includes(0)?s(!1):s(!0),r.includes(e.length-1)?p(!1):p(!0))},[r]);let m=a=>{o(r.map(l=>l+a))};return $.createElement(ue,{ref:c},t&&$.createElement($.Fragment,null,$.createElement(R,{increment:-1,label:"previous",handleControl:m,height:t,disabled:!i}),$.createElement(R,{increment:1,label:"next",handleControl:m,height:t,disabled:!g})),e.filter((a,l)=>{if(r.includes(l))return a}).map((a,l)=>$.createElement(de,{index:l,item:a,key:a.id})))},fe=Re;import I,{useEffect as je,useState as Oe}from"react";var he=n("div",{display:"flex",flexDirection:"column",paddingBottom:"$4",margin:"0",color:"$primary",lineHeight:"1.4em",".bloom-header-homepage":{color:"$accent",textDecoration:"none"},".bloom-header-label":{fontSize:"$6",fontWeight:"400",fontFamily:"$display"},".bloom-header-summary":{fontSize:"$4",marginTop:"$2"}});import{Homepage as Ve,Label as ge,Summary as We}from"@samvera/nectar-iiif";var Ge=({label:e,summary:t,homepage:r})=>{let[o,i]=Oe(!1);return je(()=>{r.length>0&&i(!0)},[r]),I.createElement(he,null,o?I.createElement(Ve,{homepage:r,className:"bloom-header-homepage"},I.createElement(ge,{label:e,as:"span",className:"bloom-header-label"})):I.createElement(ge,{label:e,as:"span",className:"bloom-header-label"}),t&&I.createElement(We,{summary:t,as:"span",className:"bloom-header-summary"}))},be=Ge;var Je=e=>h.createElement(X,null,h.createElement(Ke,{...e})),Ke=({collectionId:e})=>{let t=v(),{vault:r}=t,[o,i]=qe();return Ue(()=>{r.loadCollection(e).then(s=>i(s)).catch(s=>{console.error(`Collection failed to load: ${s}`)}).finally(()=>{})},[]),!o||!o.items?(console.log(`The IIIF Collection ${e} failed to load.`),h.createElement(h.Fragment,null)):o.items.length===0?(console.log(`The IIIF collection ${e} does not contain items.`),h.createElement(h.Fragment,null)):h.createElement(Qe,null,h.createElement(be,{label:o.label,summary:o.summary,homepage:o.homepage}),h.createElement(fe,{items:o.items}))},Qe=n("div",{padding:"$4 0"}),po=Je;export{po as default};
//# sourceMappingURL=index.esm.js.map
